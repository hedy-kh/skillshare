"use strict";(globalThis.webpackChunk_clerk_clerk_js=globalThis.webpackChunk_clerk_clerk_js||[]).push([[229],{4095:function(e,i,t){t.d(i,{l:function(){return z}});var a=t(2903),o=t(221),n=t(2784),r=t(8173),l=t(3476),s=t(8690),c=t(5802),d=t(4334),u=t(3736),g=t(1609),m=t(9654);const h=e=>/^\S+@\S+\.\S+$/.test(e),z=e=>{const{navigate:i}=(0,u.useRouter)(),{onSuccess:t,onReset:c=(()=>i("..")),resetButtonLabel:m}=e,{organization:z}=(0,r.useCoreOrganization)(),f=(0,s.useCardState)(),{t:p,locale:b}=(0,d.zJ)(),[P,y]=(0,n.useState)(!1);if(!z)return null;const Z=(0,g.Yp)("emailAddress","",{type:"text",label:(0,d.u1)("formFieldLabel__emailAddresses")}),{props:{setError:S,setWarning:_,setSuccess:C,setInfo:x,validatePassword:K,setHasPassedComplexity:T,hasPassedComplexity:B,feedback:D,feedbackType:R,clearFeedback:w,...L}}=Z,F=!!Z.value.length||P;return(0,a.BX)(s.Form.Root,{onSubmit:e=>{e.preventDefault();const i=new FormData(e.currentTarget);return z.inviteMembers({emailAddresses:Z.value.split(","),role:i.get("role")}).then(t).catch((e=>{var i,t,a;if((0,o.kD)(e)&&(e=>{var i,t,a,o;const n=new Set([...null!==(t=null===(i=e.meta)||void 0===i?void 0:i.emailAddresses)&&void 0!==t?t:[],...null!==(o=null===(a=e.meta)||void 0===a?void 0:a.identifiers)&&void 0!==o?o:[]]),r=Z.value.split(",");Z.setValue(r.filter((e=>!n.has(e))).join(","))})(e.errors[0]),(0,o.kD)(e)&&"duplicate_record"===(null===(t=null===(i=e.errors)||void 0===i?void 0:i[0])||void 0===t?void 0:t.code)){const i=(null===(a=e.errors[0].meta)||void 0===a?void 0:a.emailAddresses)||[];f.setError(p((0,d.u1)("organizationProfile.invitePage.detailsTitle__inviteFailed",{email_addresses:(0,g.z$)(i,b)})))}else(0,g.S3)(e,[],f.setError)}))},children:[(0,a.tZ)(s.Form.ControlRow,{elementId:Z.id,children:(0,a.BX)(l.Flex,{direction:"col",gap:2,sx:{width:"100%"},children:[(0,a.tZ)(l.Text,{localizationKey:(0,d.u1)("formFieldLabel__emailAddresses")}),(0,a.tZ)(l.Text,{localizationKey:(0,d.u1)("formFieldInputPlaceholder__emailAddresses"),colorScheme:"neutral",sx:e=>({fontSize:e.fontSizes.$xs})}),(0,a.tZ)(s.TagInput,{...L,autoFocus:!0,validate:h,sx:{width:"100%"},validateUnsubmittedEmail:e=>y(h(e))})]})}),(0,a.tZ)(v,{}),(0,a.BX)(s.FormButtonContainer,{children:[(0,a.tZ)(s.Form.SubmitButton,{block:!1,isDisabled:!F,localizationKey:(0,d.u1)("organizationProfile.invitePage.formButtonPrimary__continue")}),(0,a.tZ)(s.Form.ResetButton,{localizationKey:m||(0,d.u1)("userProfile.formButtonReset"),block:!1,onClick:c})]})]})},v=()=>{const{options:e,isLoading:i}=(0,c.e)(),t=(0,g.Yp)("role","",{label:(0,d.u1)("formFieldLabel__role")});return(0,a.tZ)(s.Form.ControlRow,{elementId:t.id,children:(0,a.BX)(l.Flex,{direction:"col",gap:2,children:[(0,a.tZ)(l.Text,{localizationKey:t.label}),(0,a.tZ)(m.DQ,{...t.props,roles:e,isDisabled:i,onChange:e=>t.setValue(e),triggerSx:e=>({width:e.sizes.$48,justifyContent:"space-between",display:"flex"}),optionListSx:e=>({minWidth:e.sizes.$48})})]})})}},2848:function(e,i,t){t.d(i,{a:function(){return z},F:function(){return h}});var a=t(2903),o=t(996),n=t(5480),r=t(8173),l=t(3476),s=t(8690),c=t(4804),d=t(3736);const u=({__unstable_manageBillingUrl:e,__unstable_manageBillingMembersLimit:i})=>{const t=(0,d.useRouter)();return(0,a.BX)(l.Flex,{sx:e=>({background:e.colors.$blackAlpha50,padding:e.space.$4,borderRadius:e.radii.$md}),children:[(0,a.tZ)(l.AlertIcon,{variant:"warning",colorScheme:"danger",sx:e=>({marginTop:e.space.$1})}),(0,a.BX)(l.Text,{variant:"regularRegular",sx:e=>({fontWeight:e.fontWeights.$normal,lineHeight:e.lineHeights.$tall}),children:["This organization is limited to ",(0,o.OR)(i)," members.",(0,a.tZ)("br",{}),(0,a.tZ)(l.Link,{variant:"regularRegular",sx:e=>({alignSelf:"flex-start",color:e.colors.$primary500,fontWeight:e.fontWeights.$normal}),onClick:()=>t.navigate((0,o.OR)(e)),children:"Upgrade for unlimited members"})]})]})};var g=t(4095),m=t(2609);const h=(0,s.withCardStateProvider)((()=>{const e=(0,l.localizationKeys)("organizationProfile.invitePage.title"),i=(0,l.localizationKeys)("organizationProfile.invitePage.subtitle"),t=(0,s.useCardState)(),c=(0,n.a2)({onNextStep:()=>t.setError(void 0)}),{organization:d}=(0,r.useCoreOrganization)(),{__unstable_manageBillingUrl:h,__unstable_manageBillingMembersLimit:v}=(0,r.useOrganizationProfileContext)();if(!d)return null;const f=!!v&&(0,o.OR)(v)<=d.pendingInvitationsCount+d.membersCount;return(0,a.BX)(n.en,{...c.props,children:[(0,a.BX)(s.ContentPage,{headerTitle:e,headerSubtitle:i,Breadcrumbs:m.G,children:[f&&h&&(0,a.tZ)(u,{__unstable_manageBillingUrl:h,__unstable_manageBillingMembersLimit:v}),(0,a.tZ)(g.l,{onSuccess:c.nextStep})]}),(0,a.tZ)(s.SuccessPage,{title:e,contents:(0,a.tZ)(z,{}),Breadcrumbs:m.G})]})})),z=()=>(0,a.BX)(l.Flex,{direction:"col",center:!0,gap:4,children:[(0,a.tZ)(s.IconCircle,{boxElementDescriptor:l.descriptors.invitationsSentIconBox,iconElementDescriptor:l.descriptors.invitationsSentIcon,icon:c.GT}),(0,a.tZ)(l.Text,{localizationKey:(0,l.localizationKeys)("organizationProfile.invitePage.successMessage")})]})},9654:function(e,i,t){t.d(i,{DQ:function(){return d},RN:function(){return c},wQ:function(){return l}});var a=t(2903),o=(t(2784),t(3476)),n=t(8690),r=t(5802);const l=e=>{const{headers:i,page:t,onPageChange:r,rows:l,isLoading:c,itemCount:d,itemsPerPage:u,pageCount:g,emptyStateLocalizationKey:m}=e,h=d>0?Math.max(0,(t-1)*u)+1:0,z=Math.min(t*u,d);return(0,a.BX)(o.Col,{gap:4,sx:{width:"100%"},children:[(0,a.tZ)(o.Flex,{sx:{overflowX:"auto"},children:(0,a.BX)(o.Table,{sx:{width:"100%"},children:[(0,a.tZ)(o.Thead,{children:(0,a.tZ)(o.Tr,{children:i.map(((e,i)=>(0,a.tZ)(o.Th,{elementDescriptor:o.descriptors.tableHead,localizationKey:e},i)))})}),(0,a.tZ)(o.Tbody,{children:c?(0,a.tZ)(o.Tr,{children:(0,a.tZ)(o.Td,{colSpan:4,children:(0,a.tZ)(o.Spinner,{colorScheme:"primary",sx:{margin:"auto",display:"block"}})})}):l.length?l:(0,a.tZ)(s,{localizationKey:m},"empty")})]})}),(0,a.tZ)(n.Pagination,{count:g,page:t,onChange:r,siblingCount:1,rowInfo:{allRowsCount:d,startingRow:h,endingRow:z}})]})},s=e=>(0,a.tZ)(o.Tr,{children:(0,a.tZ)(o.Td,{colSpan:4,children:(0,a.tZ)(o.Text,{localizationKey:e.localizationKey,sx:e=>({margin:"auto",display:"block",width:"fit-content",fontSize:e.fontSizes.$xs})})})}),c=e=>(0,a.tZ)(o.Tr,{...e,sx:e=>({":hover":{backgroundColor:e.colors.$blackAlpha50}})}),d=e=>{const{value:i,roles:t,onChange:o,isDisabled:l,triggerSx:s,optionListSx:c}=e,d=!t,u=[{label:"admin",value:"admin"},{label:"basic_member",value:"basic_member"}],{localizeCustomRole:g}=(0,r.q)(),m=[...t||[],...u,{label:"guest_member",value:"guest_member"}].find((e=>e.value===i)),h=(d?u:t).map((e=>({value:e.value,label:g(e.value)||e.label})));return(0,a.BX)(n.Select,{elementId:"role",options:h,value:i,onChange:e=>o(e.value),children:[(0,a.tZ)("input",{name:"role",type:"hidden",value:i}),(0,a.tZ)(n.SelectButton,{sx:s||(e=>({color:e.colors.$colorTextSecondary,backgroundColor:"transparent"})),isDisabled:l,children:g(null==m?void 0:m.value)||(null==m?void 0:m.label)}),(0,a.tZ)(n.SelectOptionList,{sx:c})]})}},6884:function(e,i,t){t.d(i,{D:function(){return r}});var a=t(2903),o=t(8690),n=t(4334);const r=e=>{const{organization:i,...t}=e;return(0,a.tZ)(o.AvatarUploader,{...t,title:(0,n.u1)("userProfile.profilePage.imageFormTitle"),avatarPreview:(0,a.tZ)(o.OrganizationAvatar,{size:e=>e.sizes.$11,...i})})}},2609:function(e,i,t){t.d(i,{G:function(){return l},M:function(){return r}});var a=t(2903),o=(t(2784),t(8173)),n=t(8690);const r=e=>{const{organization:i}=(0,o.useCoreOrganization)(),{pages:t}=(0,o.useOrganizationProfileContext)();return i?(0,a.BX)(n.NavbarContextProvider,{children:[(0,a.tZ)(n.NavBar,{header:(0,a.tZ)(n.OrganizationPreview,{size:"sm",organization:i,sx:e=>({margin:`0 0 ${e.space.$4} ${e.space.$2}`})}),routes:t.routes,contentRef:e.contentRef}),e.children]}):null},l=e=>{const{pages:i}=(0,o.useOrganizationProfileContext)();return(0,a.tZ)(n.Breadcrumbs,{...e,pageToRootNavbarRoute:i.pageToRootNavbarRouteMap})}},4821:function(e,i,t){t.r(i),t.d(i,{OrganizationProfile:function(){return re},OrganizationProfileModal:function(){return le}});var a=t(2903),o=t(2784),n=t(5480),r=t(8173),l=t(3476),s=t(8690),c=t(3736),d=t(2609),u=t(3185),g=t(8246),m=t(1609);const h=()=>{const e=(0,s.useCardState)(),{navigateAfterLeaveOrganization:i}=(0,r.useOrganizationProfileContext)(),{organization:t}=(0,r.useCoreOrganization)(),o=(0,r.useCoreUser)();return t?(0,a.tZ)(v,{organizationName:null==t?void 0:t.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.actionDescription",{organizationName:null==t?void 0:t.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.successMessage"),onConfirmation:()=>e.runAsync(o.leaveOrganization(t.id)).then(i)}):null},z=()=>{const e=(0,s.useCardState)(),{navigateAfterLeaveOrganization:i}=(0,r.useOrganizationProfileContext)(),{organization:t}=(0,r.useCoreOrganization)();return t?(0,a.tZ)(v,{organizationName:null==t?void 0:t.name,title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),messageLine1:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine1"),messageLine2:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.messageLine2"),actionDescription:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.actionDescription",{organizationName:null==t?void 0:t.name}),submitLabel:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title"),successMessage:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.successMessage"),onConfirmation:()=>e.runAsync(t.destroy()).then(i)}):null},v=(0,s.withCardStateProvider)((e=>{const{title:i,messageLine1:t,messageLine2:o,actionDescription:r,organizationName:u,successMessage:g,submitLabel:h,onConfirmation:z,colorScheme:v="danger"}=e,f=(0,n.a2)(),p=(0,s.useCardState)(),{navigate:b}=(0,c.useRouter)(),P=(0,m.Yp)("deleteOrganizationConfirmation","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__confirmDeletion"),isRequired:!0,placeholder:u}),y=!r||P.value===u;return(0,a.BX)(n.en,{...f.props,children:[(0,a.tZ)(s.ContentPage,{headerTitle:i,breadcrumbTitle:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.title"),Breadcrumbs:d.G,children:(0,a.BX)(s.Form.Root,{onSubmit:async()=>{if(y)try{await z().then((()=>f.nextStep()))}catch(e){(0,m.S3)(e,[],p.setError)}},children:[(0,a.tZ)(l.Text,{localizationKey:t}),(0,a.tZ)(l.Text,{localizationKey:o}),(0,a.tZ)(l.Text,{localizationKey:r}),(0,a.tZ)(s.Form.ControlRow,{elementId:P.id,children:(0,a.tZ)(s.Form.Control,{...P.props,required:!0})}),(0,a.BX)(s.FormButtonContainer,{children:[(0,a.tZ)(s.Form.SubmitButton,{block:!1,colorScheme:v,localizationKey:h,isDisabled:!y}),(0,a.tZ)(s.Form.ResetButton,{localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset"),block:!1,onClick:async()=>{await b("..")}})]})]})}),(0,a.tZ)(s.SuccessPage,{title:i,text:g})]})})),f=(0,s.withCardStateProvider)((()=>{const{organizationSettings:e}=(0,r.useEnvironment)(),i=(0,l.localizationKeys)("organizationProfile.createDomainPage.title"),t=(0,l.localizationKeys)("organizationProfile.createDomainPage.subtitle"),o=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),n=(0,s.useCardState)(),{organization:u}=(0,r.useCoreOrganization)(),{navigate:g}=(0,c.useRouter)(),h=(0,m.Yp)("name","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomain"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomain")});if(!u||!e)return null;const z=""!==h.value.trim();return(0,a.tZ)(s.ContentPage,{headerTitle:i,headerSubtitle:t,breadcrumbTitle:o,Breadcrumbs:d.G,children:(0,a.BX)(s.Form.Root,{onSubmit:e=>(h.setError(void 0),e.preventDefault(),u.createDomain(h.value).then((e=>e.verification&&"verified"===e.verification.status?g(`../domain/${e.id}?mode=select`):g(`../domain/${e.id}/verify`))).catch((e=>{(0,m.S3)(e,[h],n.setError)}))),children:[(0,a.tZ)(s.Form.ControlRow,{elementId:h.id,children:(0,a.tZ)(s.Form.Control,{...h.props,autoFocus:!0,required:!0})}),(0,a.tZ)(s.FormButtons,{isDisabled:!z})]})})}));var p=t(2848),b=t(9813),P=t(5802),y=t(9654);const Z={memberships:{pageSize:10,keepPreviousData:!0}},S=()=>{const e=(0,s.useCardState)(),{organization:i,memberships:t}=(0,r.useCoreOrganization)(Z),{options:o,isLoading:n}=(0,P.e)();if(!i)return null;const c=i=>async()=>e.runAsync((async()=>{var e;const a=await i.destroy();return await(null===(e=null==t?void 0:t.revalidate)||void 0===e?void 0:e.call(t)),a})).catch((i=>(0,m.S3)(i,[],e.setError)));return(0,a.tZ)(y.wQ,{page:(null==t?void 0:t.page)||1,onPageChange:e=>{var i;return null===(i=null==t?void 0:t.fetchPage)||void 0===i?void 0:i.call(t,e)},itemCount:(null==t?void 0:t.count)||0,pageCount:(null==t?void 0:t.pageCount)||0,itemsPerPage:Z.memberships.pageSize,isLoading:(null==t?void 0:t.isLoading)||n,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.detailsTitle__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__joined"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==t?void 0:t.data)||[]).map((i=>{return(0,a.tZ)(_,{membership:i,options:o,onRoleChange:(t=i,i=>e.runAsync((async()=>await t.update({role:i}))).catch((i=>(0,m.S3)(i,[],e.setError)))),onRemove:c(i)},i.id);var t}))})},_=e=>{const{membership:i,onRemove:t,onRoleChange:o,options:n}=e,{localizeCustomRole:c}=(0,P.q)(),d=(0,s.useCardState)(),u=(0,r.useCoreUser)().id===i.publicUserData.userId;return(0,a.BX)(y.RN,{children:[(0,a.tZ)(l.Td,{children:(0,a.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:i.publicUserData,subtitle:i.publicUserData.identifier,badge:u&&(0,a.tZ)(l.Badge,{textVariant:"extraSmallMedium",localizationKey:(0,l.localizationKeys)("badge__you")})})}),(0,a.tZ)(l.Td,{children:i.createdAt.toLocaleDateString()}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(b.Cc,{permission:"org:sys_memberships:manage",fallback:(0,a.tZ)(l.Text,{sx:e=>({opacity:e.opacity.$inactive}),children:c(i.role)}),children:(0,a.tZ)(y.DQ,{isDisabled:d.isLoading||!o,value:i.role,onChange:o,roles:n})})}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(b.Cc,{permission:"org:sys_memberships:delete",children:(0,a.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.menuAction__remove"),isDestructive:!0,onClick:t,isDisabled:u}],elementId:"member"})})})]})};var C=t(996);const x=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{__unstable_manageBillingUrl:i,__unstable_manageBillingLabel:t,__unstable_manageBillingMembersLimit:o}=(0,r.useOrganizationProfileContext)(),n=(0,c.useRouter)();if(!e)return null;const s=(null==e?void 0:e.membersCount)+(null==e?void 0:e.pendingInvitationsCount);return(0,a.BX)(l.Flex,{sx:e=>({background:e.colors.$blackAlpha50,padding:e.space.$4,justifyContent:"space-between",alignItems:"flex-start",borderRadius:e.radii.$md}),children:[(0,a.BX)(l.Col,{children:[(0,a.tZ)(l.Text,{sx:e=>({lineHeight:e.lineHeights.$tall}),children:"Members can be given access to applications."}),(0,C.OR)(o)>0&&(0,a.tZ)(l.Link,{variant:"regularRegular",sx:e=>({alignSelf:"flex-start",color:e.colors.$primary500,marginTop:e.space.$1,fontWeight:e.fontWeights.$normal}),onClick:()=>n.navigate((0,C.OR)(i)),children:(0,C.OR)(t)||"Manage billing"})]}),(0,a.tZ)(l.Col,{children:(0,a.BX)(l.Text,{variant:"regularRegular",sx:e=>({fontWeight:e.fontWeights.$normal,lineHeight:e.lineHeights.$tall,color:e.colors.$blackAlpha600}),children:[s," of"," ",o?`${(0,C.OR)(o)} members`:"unlimited"]})})]})};var K=t(4804),T=t(145);const B={manual_invitation:(0,l.localizationKeys)("organizationProfile.badge__manualInvitation"),automatic_invitation:(0,l.localizationKeys)("organizationProfile.badge__automaticInvitation"),automatic_suggestion:(0,l.localizationKeys)("organizationProfile.badge__automaticSuggestion")},D=e=>{const{organizationDomain:i}=e;return i?i.verification&&"verified"===i.verification.status?(0,a.tZ)(l.Badge,{localizationKey:B[i.enrollmentMode],colorScheme:"manual_invitation"===i.enrollmentMode?"neutral":"primary",textVariant:"extraSmallMedium"}):(0,a.tZ)(l.Badge,{localizationKey:(0,l.localizationKeys)("organizationProfile.badge__unverified"),textVariant:"extraSmallMedium",colorScheme:"danger"}):null},R=()=>{const{isAuthorizedUser:e}=(0,n.DD)({permission:"org:sys_domains:delete"}),{isAuthorizedUser:i}=(0,n.DD)({permission:"org:sys_domains:manage"});return{showDotMenu:e||i,canVerifyDomain:i,canDeleteDomain:e}},w=(e,i,t)=>(0,C.Xn)((0,C.M)((0,C.ju)(`${e}/${i}/${t||""}`))),L=({redirectSubPath:e,domainId:i})=>{const t=((e,i)=>{const{canDeleteDomain:t,canVerifyDomain:a}=R(),{navigate:o}=(0,c.useRouter)(),n=[];return a&&n.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.unverifiedDomain_menuAction__verify"),onClick:()=>o(w(e,i,"verify"))}),t&&n.push({label:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.unverifiedDomain_menuAction__remove"),isDestructive:!0,onClick:()=>o(w(e,i,"remove"))}),n})(e,i);return(0,a.tZ)(s.ThreeDotsMenu,{actions:t})},F=(0,n.rh)((e=>{const{verificationStatus:i,enrollmentMode:t,redirectSubPath:n,fallback:d,...u}=e,{organization:g,domains:m}=(0,r.useCoreOrganization)({domains:{infinite:!0,...u}}),{showDotMenu:h}=R(),{ref:z}=(0,T.YD)({threshold:0,onChange:e=>{var i;e&&(null===(i=null==m?void 0:m.fetchNext)||void 0===i||i.call(m))}}),{navigate:v}=(0,c.useRouter)(),f=(0,o.useMemo)((()=>(null==m?void 0:m.data)?m.data.filter((e=>{let a=!0,o=!0;return i&&(a=!!e.verification&&e.verification.status===i),t&&(o=e.enrollmentMode===t),a&&o})):[]),[null==m?void 0:m.data]);return g?(0,a.BX)(l.Col,{children:[0===f.length&&!(null==m?void 0:m.isLoading)&&d,f.map((e=>e.verification&&"verified"===e.verification.status&&h?(0,a.tZ)(s.ArrowBlockButton,{variant:"ghost",colorScheme:"neutral",badge:i?void 0:(0,a.tZ)(D,{organizationDomain:e}),sx:e=>({padding:`${e.space.$3} ${e.space.$4}`,minHeight:e.sizes.$10}),onClick:()=>v(w(n,e.id)),children:e.name},e.id):(0,a.tZ)(s.BlockWithTrailingComponent,{sx:e=>({"&:hover":{backgroundColor:e.colors.$blackAlpha50},padding:`${e.space.$none} ${e.space.$4}`,minHeight:e.sizes.$10}),badge:(0,a.tZ)(D,{organizationDomain:e}),trailingComponent:h?(0,a.tZ)(L,{redirectSubPath:n,domainId:e.id}):void 0,children:e.name},e.id))),((null==m?void 0:m.hasNextPage)||(null==m?void 0:m.isFetching))&&(0,a.tZ)(l.Box,{ref:(null==m?void 0:m.isFetching)?void 0:z,sx:[e=>({width:"100%",height:e.space.$10,position:"relative"})],children:(0,a.tZ)(l.Box,{sx:{display:"flex",margin:"auto",position:"absolute",left:"50%",top:"50%",transform:"translateY(-50%) translateX(-50%)"},children:(0,a.tZ)(l.Spinner,{size:"sm",colorScheme:"primary"})})})]}):null}),{permission:"org:sys_domains:read"}),k={invitations:{pageSize:10,keepPreviousData:!0}},O=()=>{const e=(0,s.useCardState)(),{organization:i,invitations:t}=(0,r.useCoreOrganization)(k);return i?(0,a.tZ)(y.wQ,{page:(null==t?void 0:t.page)||1,onPageChange:(null==t?void 0:t.fetchPage)||(()=>null),itemCount:(null==t?void 0:t.count)||0,pageCount:(null==t?void 0:t.pageCount)||0,itemsPerPage:k.invitations.pageSize,isLoading:null==t?void 0:t.isLoading,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.tableHeader__invited"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__role"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==t?void 0:t.data)||[]).map((i=>{return(0,a.tZ)(M,{invitation:i,onRevoke:(o=i,async()=>e.runAsync((async()=>{var e;return await o.revoke(),await(null===(e=null==t?void 0:t.revalidate)||void 0===e?void 0:e.call(t)),o})).catch((i=>(0,m.S3)(i,[],e.setError))))},i.id);var o}))}):null},M=e=>{const{invitation:i,onRevoke:t}=e,{localizeCustomRole:o}=(0,P.q)();return(0,a.BX)(y.RN,{children:[(0,a.tZ)(l.Td,{children:(0,a.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},user:{primaryEmailAddress:{emailAddress:i.emailAddress}}})}),(0,a.tZ)(l.Td,{children:i.createdAt.toLocaleDateString()}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(l.Text,{colorScheme:"neutral",localizationKey:o(i.role)})}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(s.ThreeDotsMenu,{actions:[{label:(0,l.localizationKeys)("organizationProfile.membersPage.invitedMembersTab.menuAction__revoke"),isDestructive:!0,onClick:t}],elementId:"invitation"})})]})},X=()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{navigate:t}=(0,c.useRouter)(),{__unstable_manageBillingUrl:o}=(0,r.useOrganizationProfileContext)(),d=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,a.BX)(l.Col,{gap:8,sx:{width:"100%"},children:[o&&(0,a.tZ)(x,{}),d&&(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",children:(0,a.BX)(l.Col,{gap:2,sx:{width:"100%"},children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerTitle"),textVariant:"largeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.headerSubtitle"),variant:"regularRegular"})]}),(0,a.tZ)(F,{fallback:(0,a.tZ)(n.of,{colorScheme:"primary",textLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.autoInvitations.primaryButton"),id:"manageVerifiedDomains",onClick:()=>t("organization-settings/domain")}),redirectSubPath:"organization-settings/domain",verificationStatus:"verified",enrollmentMode:"automatic_invitation"})]})}),(0,a.BX)(l.Flex,{direction:"col",gap:4,sx:{width:"100%"},children:[(0,a.BX)(l.Flex,{justify:"between",align:"center",children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.manualInvitations.headerTitle"),textVariant:"largeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.invitationsTab.manualInvitations.headerSubtitle"),variant:"regularRegular"})]}),(0,a.tZ)(s.IconButton,{elementDescriptor:l.descriptors.membersPageInviteButton,"aria-label":"Invite",onClick:()=>t("invite-members"),icon:(0,a.tZ)(l.Icon,{icon:K.av,size:"sm",sx:e=>({marginRight:e.space.$2})}),textVariant:"buttonExtraSmallBold",localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.action__invite")})]}),(0,a.tZ)(O,{})]})]})},$={membershipRequests:{pageSize:10,keepPreviousData:!0}},I=()=>{var e;const i=(0,s.useCardState)(),{organization:t,membershipRequests:o}=(0,r.useCoreOrganization)($);return t?(0,a.tZ)(y.wQ,{page:(null==o?void 0:o.page)||1,onPageChange:null!==(e=null==o?void 0:o.fetchPage)&&void 0!==e?e:()=>null,itemCount:(null==o?void 0:o.count)||0,pageCount:(null==o?void 0:o.pageCount)||0,itemsPerPage:$.membershipRequests.pageSize,isLoading:null==o?void 0:o.isLoading,emptyStateLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.table__emptyRow"),headers:[(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__user"),(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.tableHeader__requested"),(0,l.localizationKeys)("organizationProfile.membersPage.activeMembersTab.tableHeader__actions")],rows:((null==o?void 0:o.data)||[]).map((e=>(0,a.tZ)(A,{request:e,onError:i.setError},e.id)))}):null},A=(0,s.withCardStateProvider)((e=>{const{request:i,onError:t}=e,o=(0,s.useCardState)(),{membership:n,membershipRequests:c}=(0,r.useCoreOrganization)($);return(0,a.BX)(y.RN,{children:[(0,a.tZ)(l.Td,{children:(0,a.tZ)(s.UserPreview,{sx:{maxWidth:"30ch"},showAvatar:!1,user:{primaryEmailAddress:{emailAddress:i.publicUserData.identifier}}})}),(0,a.tZ)(l.Td,{children:i.createdAt.toLocaleDateString()}),(0,a.tZ)(l.Td,{children:(0,a.tZ)(E,{onAccept:()=>{if(n&&c)return o.runAsync((async()=>{await i.accept(),await c.revalidate()}),"accept").catch((e=>(0,m.S3)(e,[],t)))},onReject:()=>{if(n&&c)return o.runAsync((async()=>{await i.reject(),await c.revalidate()}),"reject").catch((e=>(0,m.S3)(e,[],t)))}})})]})})),E=e=>{const i=(0,s.useCardState)();return(0,a.BX)(l.Flex,{gap:2,children:[(0,a.tZ)(l.Button,{textVariant:"buttonExtraSmallBold",variant:"ghost",isLoading:i.isLoading&&"reject"===i.loadingMetadata,isDisabled:i.isLoading&&"reject"!==i.loadingMetadata,onClick:e.onReject,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__reject")}),(0,a.tZ)(l.Button,{textVariant:"buttonExtraSmallBold",variant:"solid",isLoading:i.isLoading&&"accept"===i.loadingMetadata,isDisabled:i.isLoading&&"accept"!==i.loadingMetadata,onClick:e.onAccept,localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.menuAction__approve")})]})},H=()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),{navigate:t}=(0,c.useRouter)(),{__unstable_manageBillingUrl:o}=(0,r.useOrganizationProfileContext)(),d=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled;return(0,a.BX)(l.Col,{gap:8,sx:{width:"100%"},children:[o&&(0,a.tZ)(x,{}),d&&(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",children:(0,a.BX)(l.Col,{gap:2,sx:{width:"100%"},children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerTitle"),textVariant:"largeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.headerSubtitle"),variant:"regularRegular"})]}),(0,a.tZ)(F,{fallback:(0,a.tZ)(n.of,{colorScheme:"primary",textLocalizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.autoSuggestions.primaryButton"),id:"manageVerifiedDomains",onClick:()=>t("organization-settings/domain")}),redirectSubPath:"organization-settings/domain",verificationStatus:"verified",enrollmentMode:"automatic_suggestion"})]})}),(0,a.BX)(l.Flex,{direction:"col",gap:4,sx:{width:"100%"},children:[(0,a.tZ)(l.Flex,{justify:"between",align:"center",children:(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.requests.headerTitle"),textVariant:"largeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.requestsTab.requests.headerSubtitle"),variant:"regularRegular"})]})}),(0,a.tZ)(I,{})]})]})},q=(0,s.withCardStateProvider)((()=>{var e;const{organizationSettings:i}=(0,r.useEnvironment)(),t=(0,s.useCardState)(),{isAuthorizedUser:o}=(0,n.DD)({permission:"org:sys_memberships:manage"}),c=null===(e=null==i?void 0:i.domains)||void 0===e?void 0:e.enabled,{membershipRequests:d}=(0,r.useCoreOrganization)({membershipRequests:c||void 0}),{__unstable_manageBillingUrl:u}=(0,r.useOrganizationProfileContext)();return null===o?null:(0,a.BX)(l.Col,{elementDescriptor:l.descriptors.page,gap:8,children:[(0,a.tZ)(s.CardAlert,{children:t.error}),(0,a.tZ)(s.NavbarMenuButtonRow,{}),(0,a.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationMembers"),gap:8,children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__members"),textVariant:"xxlargeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerSubtitle__members")})]}),(0,a.BX)(s.Tabs,{children:[(0,a.BX)(s.TabsList,{children:[(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__members")}),o&&(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__invitations")}),o&&c&&(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.membersPage.start.headerTitle__requests"),children:(0,a.tZ)(n.dN,{notificationCount:(null==d?void 0:d.count)||0})})]}),(0,a.BX)(s.TabPanels,{children:[(0,a.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,a.BX)(l.Flex,{gap:4,direction:"col",sx:{width:"100%"},children:[o&&u&&(0,a.tZ)(x,{}),(0,a.tZ)(S,{})]})}),o&&(0,a.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,a.tZ)(X,{})}),o&&c&&(0,a.tZ)(s.TabPanel,{sx:{width:"100%"},children:(0,a.tZ)(H,{})})]})]})]})]})})),U=()=>(0,a.BX)(l.Col,{elementDescriptor:l.descriptors.page,gap:8,children:[(0,a.tZ)(s.NavbarMenuButtonRow,{}),(0,a.BX)(l.Col,{elementDescriptor:l.descriptors.profilePage,elementId:l.descriptors.profilePage.setId("organizationSettings"),gap:8,children:[(0,a.BX)(s.Header.Root,{children:[(0,a.tZ)(s.Header.Title,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerTitle__settings"),textVariant:"xxlargeMedium"}),(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.start.headerSubtitle__settings")})]}),(0,a.tZ)(V,{}),(0,a.tZ)(n.Cc,{permission:"org:sys_domains:read",children:(0,a.tZ)(N,{})}),(0,a.tZ)(j,{})]})]}),V=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{navigate:i}=(0,c.useRouter)();if(!e)return null;const t=(0,a.tZ)(s.OrganizationPreview,{organization:e,size:"lg"});return(0,a.tZ)(s.ProfileSection,{title:(0,l.localizationKeys)("organizationProfile.profilePage.title"),id:"organizationProfile",children:(0,a.tZ)(n.Cc,{permission:"org:sys_profile:manage",fallback:(0,a.tZ)(a.HY,{children:t}),children:(0,a.tZ)(n.of,{onClick:()=>i("profile"),children:t})})})},N=()=>{const{organizationSettings:e}=(0,r.useEnvironment)(),{organization:i}=(0,r.useCoreOrganization)(),{navigate:t}=(0,c.useRouter)();return e&&i&&e.domains.enabled?(0,a.BX)(s.ProfileSection,{title:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),subtitle:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.subtitle"),id:"organizationDomains",children:[(0,a.tZ)(F,{redirectSubPath:"domain"}),(0,a.tZ)(n.Br,{textLocalizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.primaryButton"),id:"addOrganizationDomain",onClick:()=>t("domain")})]}):null},j=()=>{const{organization:e}=(0,r.useCoreOrganization)(),{navigate:i}=(0,c.useRouter)(),{isAuthorizedUser:t}=(0,n.DD)({permission:"org:sys_profile:delete"});if(!e)return null;const o=e.adminDeleteEnabled;return(0,a.tZ)(s.ProfileSection,{id:"organizationDanger",title:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.title"),sx:e=>({marginBottom:e.space.$4}),children:(0,a.BX)(l.Flex,{gap:4,children:[(0,a.tZ)(s.IconButton,{"aria-label":"Leave organization",icon:(0,a.tZ)(l.Icon,{icon:K.um,size:"sm",sx:e=>({marginRight:e.space.$2})}),variant:"outline",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>i("leave"),localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.leaveOrganization.title")}),t&&o&&(0,a.tZ)(s.IconButton,{"aria-label":"Delete organization",icon:(0,a.tZ)(l.Icon,{icon:K.um,size:"sm",sx:e=>({marginRight:e.space.$2})}),variant:"outline",colorScheme:"danger",textVariant:"buttonExtraSmallBold",onClick:()=>i("delete"),localizationKey:(0,l.localizationKeys)("organizationProfile.profilePage.dangerSection.deleteOrganization.title")})]})})};var G=t(6884);const W=(0,s.withCardStateProvider)((()=>{const e=(0,l.localizationKeys)("organizationProfile.profilePage.title"),i=(0,l.localizationKeys)("organizationProfile.profilePage.subtitle"),t=(0,s.useCardState)(),[c,u]=o.useState(!1),{organization:g}=(0,r.useCoreOrganization)(),h=(0,n.a2)({onNextStep:()=>t.setError(void 0)}),z=(0,m.Yp)("name",(null==g?void 0:g.name)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationName"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationName")}),v=(0,m.Yp)("slug",(null==g?void 0:g.slug)||"",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationSlug"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationSlug")});if(!g)return null;const f=g.name!==z.value||g.slug!==v.value,p=(f||c)&&"error"!==v.feedbackType;return(0,a.BX)(n.en,{...h.props,children:[(0,a.tZ)(s.ContentPage,{headerTitle:e,headerSubtitle:i,Breadcrumbs:d.G,children:(0,a.BX)(s.Form.Root,{onSubmit:async e=>(e.preventDefault(),(f?g.update({name:z.value,slug:v.value}):Promise.resolve()).then(h.nextStep).catch((e=>{(0,m.S3)(e,[z,v],t.setError)}))),children:[(0,a.tZ)(G.D,{organization:g,onAvatarChange:e=>g.setLogo({file:e}).then((()=>{u(!0),t.setIdle()})).catch((e=>(0,m.S3)(e,[],t.setError))),onAvatarRemove:(0,C.QO)(g.imageUrl)?null:()=>{g.setLogo({file:null}).then((()=>{u(!0),t.setIdle()})).catch((e=>(0,m.S3)(e,[],t.setError)))}}),(0,a.tZ)(s.Form.ControlRow,{elementId:z.id,children:(0,a.tZ)(s.Form.Control,{...z.props,autoFocus:!0,required:!0})}),(0,a.tZ)(s.Form.ControlRow,{elementId:v.id,children:(0,a.tZ)(s.Form.Control,{...v.props,onChange:e=>{var i;i=e.target.value,v.setValue(i),v.setError(void 0)},required:!0})}),(0,a.tZ)(s.FormButtons,{isDisabled:!p})]})}),(0,a.tZ)(s.SuccessPage,{title:e,text:(0,l.localizationKeys)("organizationProfile.profilePage.successMessage"),Breadcrumbs:d.G})]})}));var Y=t(4334);const Q=()=>{var e,i;const{organizationSettings:t}=(0,r.useEnvironment)(),{organization:s}=(0,r.useCoreOrganization)(),{params:u}=(0,c.useRouter)(),g=o.useRef(),{data:m,status:h}=(0,T.ib)(null==s?void 0:s.getDomain,{domainId:u.id},{onSuccess(e){g.current={...e}}}),{domains:z}=(0,r.useCoreOrganization)({domains:{infinite:!0}});return s&&t?h.isLoading||!m?(0,a.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,a.tZ)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(0,a.tZ)(n.hH,{title:(0,Y.u1)("organizationProfile.removeDomainPage.title"),messageLine1:(0,Y.u1)("organizationProfile.removeDomainPage.messageLine1",{domain:null===(e=g.current)||void 0===e?void 0:e.name}),messageLine2:(0,Y.u1)("organizationProfile.removeDomainPage.messageLine2"),successMessage:(0,Y.u1)("organizationProfile.removeDomainPage.successMessage",{domain:null===(i=g.current)||void 0===i?void 0:i.name}),deleteResource:()=>null==m?void 0:m.delete().then((()=>{var e;return null===(e=null==z?void 0:z.revalidate)||void 0===e?void 0:e.call(z)})),breadcrumbTitle:(0,Y.u1)("organizationProfile.profilePage.domainSection.title"),Breadcrumbs:d.G}):null};var J=t(869);const ee=(e,{infoLabel:i})=>{const t=(null==e?void 0:e.totalPendingInvitations)||0;return 0===((null==e?void 0:e.totalPendingSuggestions)||0)+t?[]:[i,(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInvitationCountLabel",{count:t}),(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutSuggestionCountLabel",{count:t})]},ie=(0,s.withCardStateProvider)((()=>{const e=(0,s.useCardState)(),{organizationSettings:i}=(0,r.useEnvironment)(),{membership:t,organization:o,domains:u}=(0,r.useCoreOrganization)({domains:{infinite:!0}}),{isAuthorizedUser:g}=(0,n.DD)({permission:"org:sys_domains:manage"}),{isAuthorizedUser:h}=(0,n.DD)({permission:"org:sys_domains:delete"}),{navigateToFlowStart:z}=(0,T.zk)(),{params:v,navigate:f,queryParams:p}=(0,c.useRouter)(),b=p.mode||"edit",P=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),y="edit"===b,Z=(0,m.Yp)("enrollmentMode","",{type:"radio",radioOptions:[...i.domains.enrollmentModes.includes("manual_invitation")?[{value:"manual_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.manualInvitationOption__description")}]:[],...i.domains.enrollmentModes.includes("automatic_invitation")?[{value:"automatic_invitation",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticInvitationOption__description")}]:[],...i.domains.enrollmentModes.includes("automatic_suggestion")?[{value:"automatic_suggestion",label:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__label"),description:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.automaticSuggestionOption__description")}]:[]]}),S=(0,m.Yp)("deleteExistingInvitationsSuggestions","",{label:(0,l.localizationKeys)("formFieldLabel__organizationDomainDeletePending"),type:"checkbox"}),{data:_,status:C}=(0,T.ib)(null==o?void 0:o.getDomain,{domainId:v.id},{onSuccess(e){Z.setValue(e.enrollmentMode)}}),x=S.checked||(null==_?void 0:_.enrollmentMode)!==Z.value,B=(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.subtitle",{domain:null==_?void 0:_.name}),D=ee(_,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.calloutInfoLabel")}),R=ee(_,{infoLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.calloutInfoLabel")});return o&&i?C.isLoading||!_?(0,a.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,a.tZ)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(_.verification&&"verified"===_.verification.status||z(),(0,a.tZ)(s.ContentPage,{headerTitle:_.name,headerSubtitle:y?void 0:B,breadcrumbTitle:P,gap:4,Breadcrumbs:d.G,children:(0,a.tZ)(l.Col,{gap:6,children:(0,a.BX)(s.Tabs,{children:[(0,a.BX)(s.TabsList,{children:[g&&(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.start.headerTitle__enrollment")}),y&&h&&(0,a.tZ)(s.Tab,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.start.headerTitle__danger")})]}),(0,a.BX)(s.TabPanels,{children:[g&&(0,a.BX)(s.TabPanel,{sx:{width:"100%"},direction:"col",gap:4,children:[D.length>0&&(0,a.tZ)(n.aX,{icon:K.I$,children:D.map(((e,i)=>(0,a.tZ)(l.Text,{as:"span",sx:[e=>({lineHeight:e.lineHeights.$short,color:"inherit",display:"block"})],localizationKey:e},i)))}),(0,a.tZ)(s.Header.Root,{children:(0,a.tZ)(s.Header.Subtitle,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.subtitle"),variant:"regularRegular"})}),(0,a.BX)(s.Form.Root,{onSubmit:async()=>{if(_&&o&&t&&u)try{await _.updateEnrollmentMode({enrollmentMode:Z.value,deletePending:S.checked}),await u.revalidate(),await f("../../")}catch(i){(0,m.S3)(i,[Z],e.setError)}},gap:6,children:[(0,a.tZ)(s.Form.ControlRow,{elementId:Z.id,children:(0,a.tZ)(s.Form.Control,{...Z.props})}),y&&(0,a.tZ)(s.Form.ControlRow,{elementId:S.id,children:(0,a.tZ)(s.Form.Control,{...S.props})}),(0,a.tZ)(s.FormButtons,{localizationKey:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.enrollmentTab.formButton__save"),isDisabled:C.isLoading||!_||!x})]})]}),y&&h&&(0,a.BX)(s.TabPanel,{direction:"col",gap:4,sx:{width:"100%"},children:[R.length>0&&(0,a.tZ)(n.aX,{icon:K.I$,children:R.map(((e,i)=>(0,a.tZ)(l.Text,{as:"span",sx:[e=>({lineHeight:e.lineHeights.$short,color:"inherit",display:"block"})],localizationKey:e},i)))}),(0,a.tZ)(l.Col,{sx:e=>({padding:`${e.space.$none} ${e.space.$4}`}),children:(0,a.tZ)(J.f,{title:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainTitle"),subtitle:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainSubtitle"),actionLabel:(0,l.localizationKeys)("organizationProfile.verifiedDomainPage.dangerTab.removeDomainActionLabel__remove"),colorScheme:"danger",onClick:()=>f(`../../domain/${_.id}/remove`)})})]})]})]})})})):null}));var te=t(6684);const ae=(0,s.withCardStateProvider)((()=>{var e;const i=(0,s.useCardState)(),{organizationSettings:t}=(0,r.useEnvironment)(),{organization:u}=(0,r.useCoreOrganization)(),{params:g,navigate:h}=(0,c.useRouter)(),[z,v]=o.useState(!1),{data:f,status:p}=(0,T.ib)(null==u?void 0:u.getDomain,{domainId:g.id}),b=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.title"),P=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitle",{domainName:null!==(e=null==f?void 0:f.name)&&void 0!==e?e:""}),y=(0,l.localizationKeys)("organizationProfile.profilePage.domainSection.title"),Z=(0,T._m)(),S=(0,m.Yp)("code",""),_=(0,s.useCodeControl)(S),C=(0,n.a2)({onNextStep:()=>i.setError(void 0)}),x=(0,m.Yp)("affiliationEmailAddress","",{type:"text",label:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddress"),placeholder:(0,l.localizationKeys)("formFieldInputPlaceholder__organizationDomainEmailAddress"),infoText:(0,l.localizationKeys)("formFieldLabel__organizationDomainEmailAddressDescription")}),K=(0,o.useRef)(),B=(0,l.localizationKeys)("organizationProfile.verifyDomainPage.subtitleVerificationCodeScreen",{emailAddress:K.current}),D=async()=>{v(!0),await(0,m._v)(750)},R=async e=>{(0,m.S3)(e,[S],i.setError),Z.setIdle(),await(0,m._v)(750),_.reset()};if(_.onCodeEntryFinished((e=>{Z.setLoading(),S.setError(void 0),((e,i,t)=>{var a;null===(a=null==f?void 0:f.attemptAffiliationVerification)||void 0===a||a.call(f,{code:e}).then((async e=>{var t;if(await i(),"verified"===(null===(t=e.verification)||void 0===t?void 0:t.status))return h(`../../../domain/${e.id}?mode=select`)})).catch((e=>t(e)))})(e,D,R)})),!u||!t)return null;const w=u.name!==x.value,L=`@${null==f?void 0:f.name}`;return p.isLoading||!f?(0,a.tZ)(l.Flex,{direction:"row",align:"center",justify:"center",sx:e=>({height:"100%",minHeight:e.sizes.$120}),children:(0,a.tZ)(l.Spinner,{size:"lg",colorScheme:"primary"})}):(0,a.BX)(n.en,{...C.props,children:[(0,a.tZ)(s.ContentPage,{headerTitle:b,breadcrumbTitle:y,headerSubtitle:P,Breadcrumbs:d.G,children:(0,a.BX)(s.Form.Root,{onSubmit:e=>{if(e.preventDefault(),f)return K.current=`${x.value}${L}`,f.prepareAffiliationVerification({affiliationEmailAddress:K.current}).then(C.nextStep).catch((e=>{(0,m.S3)(e,[x],i.setError)}))},children:[(0,a.tZ)(s.Form.ControlRow,{elementId:x.id,children:(0,a.tZ)(s.Form.Control,{...x.props,autoFocus:!0,groupSuffix:`@${f.name}`,required:!0})}),(0,a.tZ)(s.FormButtons,{isDisabled:!w})]})}),(0,a.BX)(s.ContentPage,{headerTitle:b,breadcrumbTitle:y,headerSubtitle:B,Breadcrumbs:d.G,children:[(0,a.tZ)(te.T,{title:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formTitle"),subtitle:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.formSubtitle"),resendButton:(0,l.localizationKeys)("organizationProfile.verifyDomainPage.resendButton"),isLoading:Z.isLoading,success:z,codeControl:_,onResendCodeClicked:()=>{_.reset(),null==f||f.prepareAffiliationVerification({affiliationEmailAddress:x.value}).catch((e=>{(0,m.S3)(e,[x],i.setError)}))}}),(0,a.tZ)(s.FormButtonContainer,{children:(0,a.tZ)(l.Button,{elementDescriptor:l.descriptors.formButtonReset,block:!1,variant:"ghost",textVariant:"buttonExtraSmallBold",type:"reset",isDisabled:Z.isLoading||z,onClick:C.prevStep,localizationKey:(0,l.localizationKeys)("userProfile.formButtonReset")})})]})]})})),oe=e=>{var i;const{pages:t}=(0,r.useOrganizationProfileContext)(),o=t.routes[0].id===g.b.MEMBERS,l=t.routes[0].id===g.b.SETTINGS,d=null===(i=t.contents)||void 0===i?void 0:i.map(((e,i)=>{const t=!l&&!o&&0===i;return(0,a.tZ)(c.Route,{index:t,path:t?void 0:e.url,children:(0,a.tZ)(u.O,{mount:e.mount,unmount:e.unmount})},`custom-page-${e.url}`)}));return(0,a.tZ)(s.ProfileCardContent,{contentRef:e.contentRef,children:(0,a.BX)(c.Switch,{children:[d,(0,a.BX)(c.Route,{children:[(0,a.tZ)(c.Route,{path:l?void 0:"organization-settings",children:(0,a.BX)(c.Switch,{children:[(0,a.tZ)(c.Route,{path:"profile",flowStart:!0,children:(0,a.tZ)(n.Cc,{permission:"org:sys_profile:manage",redirectTo:"../",children:(0,a.tZ)(W,{})})}),(0,a.tZ)(c.Route,{path:"domain",flowStart:!0,children:(0,a.BX)(c.Switch,{children:[(0,a.tZ)(c.Route,{path:":id/verify",children:(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../../",children:(0,a.tZ)(ae,{})})}),(0,a.tZ)(c.Route,{path:":id/remove",children:(0,a.tZ)(n.Cc,{permission:"org:sys_domains:delete",redirectTo:"../../",children:(0,a.tZ)(Q,{})})}),(0,a.tZ)(c.Route,{path:":id",children:(0,a.tZ)(n.Cc,{some:[{permission:"org:sys_domains:manage"},{permission:"org:sys_domains:delete"}],redirectTo:"../../",children:(0,a.tZ)(ie,{})})}),(0,a.tZ)(c.Route,{index:!0,children:(0,a.tZ)(n.Cc,{permission:"org:sys_domains:manage",redirectTo:"../",children:(0,a.tZ)(f,{})})})]})}),(0,a.tZ)(c.Route,{path:"leave",flowStart:!0,children:(0,a.tZ)(h,{})}),(0,a.tZ)(c.Route,{path:"delete",flowStart:!0,children:(0,a.tZ)(n.Cc,{permission:"org:sys_profile:delete",redirectTo:"../",children:(0,a.tZ)(z,{})})}),(0,a.tZ)(c.Route,{index:!0,children:(0,a.tZ)(U,{})})]})}),(0,a.tZ)(c.Route,{path:o?void 0:"organization-members",children:(0,a.BX)(c.Switch,{children:[(0,a.tZ)(c.Route,{path:"invite-members",flowStart:!0,children:(0,a.tZ)(n.Cc,{permission:"org:sys_memberships:manage",redirectTo:"../",children:(0,a.tZ)(p.F,{})})}),(0,a.tZ)(c.Route,{index:!0,children:(0,a.tZ)(q,{})})]})})]})]})})},ne=(0,r.withCoreUserGuard)((()=>{const e=o.useRef(null);return(0,a.tZ)(s.ProfileCard,{sx:{height:"100%"},children:(0,a.tZ)(d.M,{contentRef:e,children:(0,a.tZ)(oe,{contentRef:e})})})})),re=(0,n.Q6)((0,n.pK)((0,s.withCardStateProvider)((e=>{const{organization:i}=(0,r.useCoreOrganization)();return i?(0,a.tZ)(l.Flow.Root,{flow:"organizationProfile",children:(0,a.tZ)(l.Flow.Part,{children:(0,a.tZ)(c.Switch,{children:(0,a.tZ)(c.Route,{children:(0,a.tZ)(ne,{})})})})}):null})),"OrganizationProfile",{mode:"redirect"})),le=e=>{const i={...e,routing:"virtual",componentName:"OrganizationProfile",mode:"modal"};return(0,a.tZ)(c.Route,{path:"organizationProfile",children:(0,a.tZ)(r.ComponentContext.Provider,{value:i,children:(0,a.tZ)("div",{children:(0,a.tZ)(re,{...i})})})})}},869:function(e,i,t){t.d(i,{f:function(){return r}});var a=t(2903),o=t(3476),n=t(145);const r=e=>{const{title:i,subtitle:t,actionLabel:r,titleLabel:l,onClick:s,...c}=e,d=(0,n._m)(),{t:u}=(0,o.useLocalizations)();return(0,a.BX)(o.Col,{gap:2,children:[(0,a.BX)(o.Col,{gap:1,children:[(0,a.BX)(o.Flex,{gap:2,align:"center",children:[(0,a.tZ)(o.Text,{localizationKey:i,variant:"regularMedium"}),l]}),(0,a.tZ)(o.Text,{localizationKey:t,variant:"smallRegular",colorScheme:"neutral"})]}),r&&(0,a.tZ)(o.Button,{localizationKey:r,loadingText:u(r),colorScheme:"primary",variant:"link",...c,isLoading:d.isLoading,onClick:e=>{var i;d.setLoading(),s&&(null===(i=null==s?void 0:s(e))||void 0===i||i.finally((()=>d.setIdle())))}})]})}}}]);